<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administración Completa del Menú</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="admin-header">
            <h1 id="admin-restaurante-nombre">Cargando...</h1>
            <div class="header-buttons">
                <button id="download-report-btn" class="btn btn-secondary">Descargar Reporte</button>
                <button id="logout-btn" class="btn btn-danger">Cerrar Sesión</button>
            </div>
        </header>
        <section class="admin-module" id="seccion-pedidos-en-vivo" style="display: block; border-left: 5px solid #28a745;">
            <h2>Pedidos Entrantes en Tiempo Real</h2>
            <div id="pedidos-container" class="pedidos-grid">
                <p id="mensaje-no-pedidos">Aún no hay pedidos nuevos. ¡Los pedidos entrantes aparecerán aquí al instante!</p>
            </div>
        </section>
        
        <section class="admin-module" id="seccion-datos-restaurante">
            <h2 id="titulo-datos-restaurante">Datos de mi Restaurante</h2>
            <form id="edit-restaurante-form">
                <label for="edit-restaurante-nombre">Nombre del Restaurante</label>
                <input type="text" id="edit-restaurante-nombre" required>
                
                <label for="edit-restaurante-telefono">Teléfono (para WhatsApp)</label>
                <input type="text" id="edit-restaurante-telefono" required>

                <label for="restaurante-direccion">Dirección (para Google Maps)</label>
                <input type="text" id="restaurante-direccion" placeholder="Ej: Calle 100 # 20-30, Bogotá">

                <label for="restaurante-descripcion">Descripción Corta del Restaurante</label>
                <textarea id="restaurante-descripcion" rows="3" placeholder="Ej: La mejor comida tradicional de la ciudad."></textarea>
                
                <label for="restaurante-mensaje">Mensaje de Bienvenida (Opcional, para WhatsApp)</label>
                <textarea id="restaurante-mensaje" rows="2" placeholder="Ej: ¡Hola! Gracias por tu pedido en [Nombre Restaurante]."></textarea>

                <label for="logo-upload-input">Logo del Restaurante</label>
                <div class="logo-upload-container">
                    <img id="logo-preview" src="https://placehold.co/150x80/e9ecef/6c757d?text=Sin+Logo" alt="Vista previa del logo">
                    <input type="file" id="logo-upload-input" accept="image/*">
                </div>

                <label class="form-label" style="margin-top: 1rem; display: block; font-weight: bold;">Servicios Activos:</label>
                <div class="checkbox-group">
                    <input type="checkbox" id="aceptaDomicilios" name="servicios">
                    <label for="aceptaDomicilios">Acepta Pedidos a Domicilio</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="aceptaServicioEnMesa" name="servicios">
                    <label for="aceptaServicioEnMesa">Acepta Servicio en la Mesa</label>
                </div>

                <label class="form-label" style="margin-top: 1rem; display: block; font-weight: bold;">Métodos de Pago Activos:</label>
                <div class="checkbox-group">
                    <input type="checkbox" id="pago-efectivo-admin">
                    <label for="pago-efectivo-admin">Aceptar Efectivo</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="pago-tarjeta-admin">
                    <label for="pago-tarjeta-admin">Aceptar Tarjeta (Débito/Crédito)</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="pago-transferencia-admin">
                    <label for="pago-transferencia-admin">Aceptar Transferencia</label>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 1.5rem;">Actualizar Datos</button>
            </form>
            
            <div class="restaurante-actions">
                <button id="restaurante-qr-btn" class="btn">Generar QR del Menú</button>
            </div>
            <div id="qrcode-container" style="display:none; margin-top: 15px; text-align: center;">
                <h3>Código QR de tu Menú</h3>
                <p>Tus clientes pueden escanear este código para ver el menú.</p>
                <div id="qrcode"></div>
                <a id="qr-link" href="#" target="_blank" style="display: block; margin-top: 10px;"></a>
                <button id="download-qr-btn" class="btn" style="margin-top: 10px;">Descargar Imagen del QR</button>
            </div>
        </section>

        <nav class="admin-menu-nav">
            <button class="nav-btn" data-target="seccion-datos-restaurante">Datos Personales</button>
            <button class="nav-btn" data-target="seccion-titulos">Títulos del Menú</button>
            <button class="nav-btn" data-target="seccion-platos">Platos a la Carta</button>
            <button class="nav-btn" data-target="seccion-bebidas">Bebidas y Otros</button>
            <button class="nav-btn" data-target="seccion-pizzas">Pizzas</button>
            <button class="nav-btn" data-target="seccion-especiales">Especiales</button>
            <button class="nav-btn" data-target="seccion-menu-dia">Menú del Día</button>
        </nav>
        
        <section class="admin-module" id="seccion-titulos">
            <h2>Configuración de Títulos</h2>
            <p>Personaliza los nombres de las secciones de tu menú. Deja el campo vacío para usar el nombre por defecto.</p>
            <form id="titulos-form">
                <label for="titulo-platos-input">Título Platos a la Carta</label>
                <input type="text" id="titulo-platos-input" placeholder="Ej: Platos Fuertes">
                
                <label for="titulo-bebidas-input">Título Bebidas y Otros</label>
                <input type="text" id="titulo-bebidas-input" placeholder="Ej: Jugos y Refrescos">

                <label for="titulo-pizzas-input">Título Pizzas</label>
                <input type="text" id="titulo-pizzas-input" placeholder="Ej: Nuestras Pizzas">

                <label for="titulo-especiales-input">Título Especiales</label>
                <input type="text" id="titulo-especiales-input" placeholder="Ej: Promociones y Combos">

                <label for="titulo-menu-dia-input">Título Menú del Día</label>
                <input type="text" id="titulo-menu-dia-input" placeholder="Ej: Menú del Día">
                
                <button type="submit" class="btn btn-primary" style="margin-top: 1.5rem;">Guardar Títulos Personalizados</button>
            </form>
        </section>

        <section class="admin-module" id="seccion-platos">
            <h2 id="titulo-platos">Gestionar Platos a la Carta</h2>
            <form id="plato-form">
                <input type="hidden" id="plato-id">
                <label for="plato-nombre">Nombre del Plato</label>
                <input type="text" id="plato-nombre" required>
                <label for="plato-descripcion">Descripción</label>
                <textarea id="plato-descripcion" rows="2"></textarea>
                <label for="plato-precio">Precio</label>
                <input type="number" id="plato-precio" step="0.01" required>
                <label for="plato-categoria">Categoría (Ej: Fuertes, Entradas)</label>
                <input type="text" id="plato-categoria" required>
                <button type="submit" id="plato-submit-btn" class="btn btn-primary">Guardar Plato</button>
            </form>
            <h3>Platos Existentes</h3>
            <div class="table-responsive">
                <table id="platos-table">
                    <thead><tr><th>Nombre</th><th>Precio</th><th>Categoría</th><th>Disponible</th><th>Acciones</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section class="admin-module" id="seccion-bebidas">
            <h2 id="titulo-bebidas">Gestionar Bebidas y Otros</h2>
            <form id="bebida-form">
                <input type="hidden" id="bebida-id">
                <label for="bebida-nombre">Nombre de la Bebida</label>
                <input type="text" id="bebida-nombre" required>
                <label for="bebida-descripcion">Descripción</label>
                <textarea id="bebida-descripcion" rows="2"></textarea>
                <label for="bebida-precio">Precio</label>
                <input type="number" id="bebida-precio" step="0.01" required>
                <label for="bebida-categoria">Categoría (Ej: Gaseosas, Jugos, Licores)</label>
                <input type="text" id="bebida-categoria" required>
                <button type="submit" class="btn btn-primary">Guardar Bebida</button>
            </form>
            <h3>Bebidas Existentes</h3>
            <div class="table-responsive">
                <table id="bebidas-table">
                    <thead><tr><th>Nombre</th><th>Precio</th><th>Categoría</th><th>Disponible</th><th>Acciones</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section class="admin-module" id="seccion-pizzas">
            <h2 id="titulo-pizzas">Gestionar Pizzas</h2>
            <form id="pizza-form">
                <input type="hidden" id="pizza-id">
                
                <label for="pizza-nombre">Nombre de la Pizza (Ej: Hawaiana)</label>
                <input type="text" id="pizza-nombre" required>
                
                <label for="pizza-descripcion">Descripción y Composición (Ej: Completa. Jamón, Piña, Queso)</label>
                <textarea id="pizza-descripcion" rows="2"></textarea>

                <label for="pizza-categoria">Categoría de la Pizza</label>
                <select id="pizza-categoria" required>
                    <option value="Tradicional">Tradicional</option>
                    <option value="Gourmet">Gourmet</option>
                </select>
                <hr style="margin: 1.5rem 0;">

                <label class="form-label" style="font-weight: bold;">Tamaños y Precios:</label>
                <div id="variantes-container">
                    </div>
                <button type="button" id="add-variante-btn" class="btn" style="background-color: #5a6268; margin-top:1em; margin-bottom:1em;">+ Añadir Tamaño</button>

                <hr style="margin: 1.5rem 0;">

                <div class="checkbox-group">
                    <input type="checkbox" id="permiteMitades">
                    <label for="permiteMitades">Permitir combinar por mitades (mitad y mitad)</label>
                </div>

                <button type="submit" id="pizza-submit-btn" class="btn btn-primary" style="margin-top: 1.5rem;">Guardar Pizza</button>
            </form>
            
            <h3>Pizzas Existentes</h3>
            <div class="table-responsive">
                <table id="pizzas-table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Categoría</th>
                            <th>Tamaños y Precios</th>
                            <th>Permite Mitades</th>
                            <th>Disponible</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section class="admin-module" id="seccion-especiales">
            <h2 id="titulo-especiales">Gestionar Especiales</h2>
            <form id="especial-form">
                <input type="hidden" id="especial-id">
                <label for="especial-nombre">Nombre del Especial</label>
                <input type="text" id="especial-nombre" required>
                <label for="especial-descripcion">Descripción</label>
                <textarea id="especial-descripcion" rows="2"></textarea>
                <label for="especial-precio">Precio</label>
                <input type="number" id="especial-precio" step="0.01" required>
                <button type="submit" id="especial-submit-btn" class="btn btn-primary">Guardar Especial</button>
            </form>
            <h3>Especiales Existentes</h3>
            <div class="table-responsive">
                <table id="especiales-table">
                    <thead><tr><th>Nombre</th><th>Precio</th><th>Disponible</th><th>Acciones</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>
        
        <section class="admin-module" id="seccion-menu-dia">
            
            <h2 id="titulo-categorias-menu-dia">1. Gestionar Categorías para Menú del Día</h2>
            <p>Aquí creas los grupos (ej: Proteínas, Acompañantes) y las opciones dentro de cada uno.</p>
            <form id="categoria-form">
                <input type="hidden" id="categoria-id">
                <label for="categoria-nombre">Nombre de Categoría (Ej: Proteínas)</label>
                <input type="text" id="categoria-nombre" required>
                <div id="opciones-container"><label>Opciones para la categoría</label></div>
                <button type="button" id="add-opcion-btn" class="btn" style="background-color: #5a6268; margin-top:1em; margin-bottom:1em;">+ Añadir opción</button>
                <button type="submit" id="categoria-submit-btn" class="btn btn-primary">Guardar Categoría</button>
            </form>
            <h3>Categorías Existentes</h3>
            <div class="table-responsive">
                <table id="categorias-table">
                    <thead><tr><th>Nombre</th><th>Opciones</th><th>Acciones</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <hr style="margin: 3rem 0; border-top: 2px solid #ddd;">

            <h2 id="titulo-menu-dia">2. Armar Menú del Día</h2>
             <p>Una vez creadas las categorías, aquí seleccionas las opciones disponibles para la fecha que elijas.</p>
            <form id="menu-dia-form">
                <input type="hidden" id="menu-dia-id">
                <div><label for="menu-fecha">Fecha</label><input type="date" id="menu-fecha" required></div>
                <div><label for="menu-nombre">Nombre</label><input type="text" id="menu-nombre" value="Menú del Día"></div>
                <div><label for="menu-precio">Precio</label><input type="number" id="menu-precio" value="0" step="0.01"></div>
                <h3>Selección de Platos para el Menú</h3>
                <div id="menu-items-selection-container"><p>Primero debes crear categorías para armar el menú del día.</p></div>
                <button type="submit" id="menu-dia-submit-btn" class="btn btn-primary">Guardar Menú del Día</button>
            </form>
            <h3>Menús del Día Existentes</h3>
            <div class="table-responsive">
                <table id="menus-dia-table">
                    <thead><tr><th>Fecha</th><th>Nombre</th><th>Platos</th><th>Acciones</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>
        </div>

    <script src="/socket.io/socket.io.js"></script>
    
    <script src="js/admin.js?v=31"></script>
</body>
</html>